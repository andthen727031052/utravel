<!DOCTYPE html>
<html xmlns:th="http://www.springframework.org/schema/mvc">
	<head>
		<meta charset="UTF-8">
		<title>写游记</title>
	<link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="layui/css/layui.css"/>

<link href="http://css.mafengwo.net/css/cv/css+mfweditor+mfweditor:css+post+addpost:css+jquery-ui-1.9.1.custom.min^ZFQ^1545789675.css" rel="stylesheet" type="text/css"/>


    <script type="application/javascript" src="js/jquery-3.3.1.js"></script>
    <script type="application/javascript" src="js/bootstrap.js"></script>
    <script type="application/javascript" src="layui/layui.js"></script>
     <script src="js/vue.js"></script>
	<style type="text/css">
		.dhl {
    		margin-top: 20px;
    	}
    	span {
    		margin-left: 30px;
    	}
    	 a:hover {
            background-color:greenyellow;
        }
        dd {
        	width: 120px;
        	height: 35px;
        }
	</style>
	</head>
	<body>
	
		<div class="container">
			<!--顶部导航栏-->
    <div class="row" style="margin-top: 10px;">

        <div class="col-lg-2" >
			<a href="index.html"><img style="width: 120px; height: 60px;" src="images/1550844969(1).jpg"/></a>
		</div>
		<div class="col-lg-5 " style="float: left; font-size: large" >

			<div class="dhl">

				<span><a href="index.html">首页</a></span><span><a>目的地</a></span><span><a>旅游攻略</a></span><span><a>结伴</a></span><span><a>APP</a></span>
          </div> 
        </div>
        <div class="col-lg-2">
        	
                   <div class="input-group" style="margin-top: 17px;">
			      <input type="text" class="form-control" placeholder="Search for...">
			     <span class="input-group-btn">
			        <button class="btn btn-default" type="button"><span class="glyphicon glyphicon-search"></span></button>
			      </span>
			    </div><!-- /input-group -->
        </div>

        <div class="col-lg-3" style="float: right; font-size: large;width: 220px;" >
        	
        		<ul class="layui-nav layui-bg-green" lay-filter="">
        			
				  <li class="layui-nav-item"><a href="">消息</a>
				  	<dl class="layui-nav-child"> <!-- 二级菜单 -->
				      <dd><a href="">私信</a></dd>
				      <dd><a href="">小组消息</a></dd>
				      <dd><a href="">系统通知</a></dd>
				      <dd><a href="">问答消息</a></dd>
				      <dd><a href="">回复消息</a></dd>
				      <dd><a href="">好友动态</a></dd>
				    </dl>
				  </li>
				  	 
				  <li class="layui-nav-item">
				    <a href=";">我的</a>
				    <dl class="layui-nav-child"> <!-- 二级菜单 -->
						<dd><a href="userinfo.html">个人中心</a></dd>
						<dd><a href="write.html">写游记</a></dd>
						<dd><a href="userinfo.html">设置</a></dd>
						<dd><a href="login.html">退出</a></dd>
				    </dl>
				  </li>
				</ul>
        	
        </div>
    </div>
    
    <div class="row">
    	<div class="col-lg-12">
    		<div class="ap-head" style="margin-left: 108px;">
		        <h1>发表新话题/文章</h1>
		        <dl d-data="1" class="on">
		            <dt>游记</dt>
		            <!--<dd>关联至具体的旅行目的地</dd>-->
		        </dl>
		 
		        <div class="clearfix"></div>
    		</div>
    	</div>
    </div>
    
    <div class="row" style="margin-top: 30px;">
    	<div class="col-lg-12">
    		<form class="layui-form" enctype='multipart/form-data' method="post" onsubmit="return false">
    			 

			  <div class="layui-form-item">
			   <!-- <label class="layui-form-label">输入框</label>-->
			    <div class="layui-input-block">
			      <input type="text" name="title" required  lay-verify="required" placeholder="请在这里输入标题" autocomplete="off" class="layui-input">
			    </div>
			  </div>

				<div class="layui-form-item">
					<!-- <label class="layui-form-label">输入框</label>-->
					<div class="layui-input-block">
						<input type="text" name="place" required  lay-verify="required" placeholder="目的地" autocomplete="off" class="layui-input">
					</div>
				</div>

			   <div class="layui-form-item  ">


					<div class="layui-input-block" >

							<button type="button" class="layui-btn"  id="test1" >
							  <i class="layui-icon">&#xe608;</i> 添加照片
							</button>


					</div>
			    </div>
				<!--<div class="layui-form-item">
					&lt;!&ndash;<label class="layui-form-label">添加照片</label>&ndash;&gt;
					<div class="layui-input-inline uploadHeadImage">
						<div class="layui-upload-drag" id="headImg">
							<i class="layui-icon"></i>
							<p>点击上传图片，或将图片拖拽到此处</p>
						</div>
					</div>
					<div class="layui-input-inline">
						<div class="layui-upload-list">
							<img class="layui-upload-img headImage" src="http://t.cn/RCzsdCq" id="demo1">
							<p id="demoText"></p>
						</div>
					</div>
				</div>-->

				<div class="layui-form-item">
					<!-- <label class="layui-form-label">输入框</label>-->
					<div class="layui-input-block">
						<input type="hidden" name="imgPath" id="imgPath" required  lay-verify="required"  autocomplete="off" class="layui-input">
					</div>
				</div>

			  <div class="layui-form-item layui-form-text">
			    <!--<label class="layui-form-label">文本域</label>-->
			    <div class="layui-input-block">
			      <textarea name="contents" placeholder="请输入内容" class="layui-textarea" id="contents" style="height: 600px;width: 700px;"></textarea>
			    </div>
			  </div>
			  <div class="layui-form-item">
			    <div class="layui-input-block">
			      <button class="layui-btn" lay-submit lay-filter="formDemo" id="addArt" >发表</button>
			    </div>
			  </div>
			</form>
    	</div>


    	
    </div>
    
        

    
		</div>
<div class="container-fluid">

<!--底栏-->
	<div class="row" style="background: gray;margin-top: 40px;">
		<div class="col-lg-2"></div>
		<div class="col-lg-8" >
			<p style="color: white;">
				© 2019 Mafengwo.cn 京ICP备11015476号 京公网安备11010502013401号 京ICP证110318号违法和不良信息举报电话: 010-59222790 举报邮箱 mfwyouji@mafengwo.com

网络出版服务许可证：(总)网出证(京)字第161号增值电信业务经营许可证：京B2-20180228 营业执照帮助中心马蜂窝客服：国内4006-345-678海外 +86-10-5922-2799
			</p>
		</div>
		<div class="col-lg-2"></div>
	</div>
</div>

		<script>
			$(function () {
				$.ajax({
					type:"get",
					url:"/utravel/user/getUser.do",
					dataType:"json",
					success:function(data){
					    if (data.code!=1){
					      layer.msg("请登录后再来分享");
						}
					}
				})
            })

		</script>


		<script>
			var layer;
			var layedit;
            layui.use(["jquery", "upload", "form", "layer", "element","layedit"], function(){
                var upload = layui.upload,
                	$ = layui.$,
                    element = layui.element,
                    form = layui.form;
                    layedit = layui.layedit;
                    layer = layui.layer;


                    form = layui.form;
                //执行实例
                var uploadInst = upload.render({
                    elem: '#test1', //绑定元素
                    url: '/utravel/addImg.do', //上传接口
                    //multiple: true,
                    done: function(res){
                        //上传完毕回调
						if (res.code==0){
						    var temp = $("#imgPath").val();
							$("#imgPath").val(temp+res.data.src+";");
							layer.msg("上传成功！！！");
						}
                    }
                    ,error: function(){
                        //请求异常回调
						alert("请求异常");
                    }
                });


                //监听提交
                form.on('submit(formDemo)', function(data){
                    //layer.msg(JSON.stringify(data.field));
                    $.ajax({
						url:'/utravel/addArt.do',
						type:"post",
						data:data.field,
						dataType:"json",
						success:function (res) {
						    if (res.code==1){
						        layer.msg("发表成功");
						        setTimeout(function () {
                                    window.location.reload();
                                },1000)

							} else{
						        layer.msg(res.info);
							}

                        }
					})


                    return false;
                });

                layedit.set({
                    uploadImage: {
                        url: '/utravel/addImg.do' //接口url
                        ,type: 'post' //默认post
						/*,success:function (res) {
							if (res.code==0){
                                var temp = $("#contents").val();
                                $("#contents").val(temp+res.data.src+";");
                                alert("上传成功！！！");
							}
                        }*/
                    }
                });

				var editIndex = layedit.build('contents',{

				});


            });

		</script>



	</body>
</html>



